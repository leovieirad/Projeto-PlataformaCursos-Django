{% extends 'base.html' %}
{% block title %}Perfil do Usuário{% endblock %}

{% block content %}
<div class="d-flex align-items-center mb-4">
  {% if usuario.foto %}
    <img src="{{ usuario.foto.url }}" class="rounded-circle me-3" style="width: 80px; height: 80px; object-fit: cover;">
  {% else %}
    <img src="https://via.placeholder.com/80" class="rounded-circle me-3" alt="Foto padrão">
  {% endif %}
  <div>
    <h2 class="mb-1">{{ usuario.first_name }} {{ usuario.last_name }}</h2>
    <p class="mb-0"><strong>Email:</strong> {{ usuario.email }}</p>
  </div>
</div>

<h3 class="mt-4">Cursos Matriculados</h3>

{% for m in matriculas %}
  {% with progresso|dictsort:"0" as p %}
    {% with p|get_item:m.curso.id as prog %}
      <div class="mb-3 p-3 bg-light rounded">
        <h5>{{ m.curso.titulo }}</h5>
        <div class="progress mb-1" style="height: 20px;">
          <div class="progress-bar bg-success" role="progressbar"
               style="width: {{ prog.percentual }}%;"
               aria-valuenow="{{ prog.percentual }}" aria-valuemin="0" aria-valuemax="100">
            {{ prog.percentual }}%
          </div>
        </div>
        <small>{{ prog.assistidas }} de {{ prog.total }} aulas assistidas</small>
      </div>
    {% endwith %}
  {% endwith %}
{% empty %}
  <p>Você ainda não está matriculado em nenhum curso.</p>
{% endfor %}
{% endblock %}