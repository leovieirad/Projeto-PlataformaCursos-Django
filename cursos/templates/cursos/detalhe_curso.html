{% extends 'base.html' %}

{% block title %}{{ curso.titulo }}{% endblock %}

{% block content %}
<h2>{{ curso.titulo }}</h2>
<p>{{ curso.descricao }}</p>

{% if curso.imagem %}
    <img src="{{ curso.imagem.url }}" class="img-fluid mb-3" alt="Imagem do curso">
{% endif %}

{% if user.is_authenticated %}
    {% if not curso.matriculas.filter(usuario=user).exists %}
        <form method="post" action="{% url 'matricular_curso' curso.slug %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-success">Matricular-se neste curso</button>
        </form>
    {% else %}
        <div class="alert alert-info mt-3">Você está matriculado neste curso.</div>
    {% endif %}
{% else %}
    <div class="alert alert-warning">Faça login para se matricular neste curso.</div>
{% endif %}

<hr>

<h4>Aulas:</h4>
<ul class="list-group">
    {% for aula in aulas %}
        <li class="list-group-item">
            <strong>{{ aula.titulo }}</strong><br>
            {% if aula.video_url %}
                <div class="ratio ratio-16x9 my-2">
                    <iframe src="{{ aula.video_url|safe }}" frameborder="0" allowfullscreen></iframe>
                </div>
            {% endif %}
            {% if aula.conteudo %}
                <p>{{ aula.conteudo }}</p>
            {% endif %}
        </li>
    {% empty %}
        <li class="list-group-item">Este curso ainda não possui aulas.</li>
    {% endfor %}
</ul>

<a href="/" class="btn btn-link mt-3">← Voltar para os cursos</a>
{% endblock %}
